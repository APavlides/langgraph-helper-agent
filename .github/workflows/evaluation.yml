name: RAGAS Evaluation

on:
  push:
    branches: [main, master]
    paths:
      - "src/**"
      - "evaluation/**"

jobs:
  evaluate:
    name: Run RAGAS Evaluation
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Verify vector store exists
        run: |
          if [ ! -f "data/vectorstore/index.faiss" ]; then
            echo "❌ Vector store not found!"
            echo "Run locally: python scripts/build_vectorstore.py"
            exit 1
          fi
          size=$(du -h data/vectorstore/index.faiss | cut -f1)
          echo "✓ Vector store found ($size)"

      - name: Summary
        run: |
          echo "## ✅ Vector Store Ready" >> $GITHUB_STEP_SUMMARY
          echo "RAGAS evaluation can proceed" >> $GITHUB_STEP_SUMMARY
          echo "" >> $GITHUB_STEP_SUMMARY
          echo "**Note:** Full evaluation runs locally before commit" >> $GITHUB_STEP_SUMMARY
